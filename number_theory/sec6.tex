\section{Primality Testing and Factorisation}\label{sec:primality-testing-and-factorisation}

\begin{itemize}
    \item (Fermat) pseudoprime to base $b$ ------ $n$ odd composite, $(b, n) = 1$, $b^{n-1} \equiv 1 \pmod{n}$
\end{itemize}

\begin{lemma}
    $n$ pseudoprime to bases $b_1$, $b_2$, then $n$ pseudoprime to base $b_1 b_2$, $b_1 b_2^{-1}$
\end{lemma}

\begin{prop}
    $n$ not pseudoprime to some base $b$, then at least half of bases, $n$ not pseudoprime
\end{prop}
\begin{pf}
    $B = $ $\left\{ \text{all bases st } n \text{ pseudoprime} \right\}$, then $f : B \rightarrow \left( \frac{\Z}{n\Z} \right)^\times \backslash \, B$,
    $f(b_1) = f(b b_1)$, injection as $B$ group
\end{pf}

\begin{itemize}
    \item Carmichael number ------ odd composite $n \in \N$, pseudoprime to every base
\end{itemize}

\begin{fact}
    $\exists$ infinite many Carmichael numbers
\end{fact}

\begin{itemize}
    \item Euler pseudoprime to base $b$ ------ $n$ odd composite, $(b, n) = 1$, $b^{\frac{n-1}{2}} \equiv \legen{b}{n} \pmod{n}$
\end{itemize}

\begin{prop}
    $n$ not Euler pseudoprime to some base $b$, then at least half of bases, $n$ not Euler pseudoprime
\end{prop}
\begin{pf}
    similar
\end{pf}

\begin{fact}
    Euler $\Rightarrow$ Fermat
\end{fact}

\begin{prop}
    $n$ odd composite, then $n$ Euler pseudoprime to at most half of all bases
\end{prop}
\begin{pf}
    if $p^2 \mid n$, pick $b = g^{p-1}$ as $p \nmid n - 1$\\
    if $n$ distict product primes, pick $\legen{\lambda}{p} = -1$,
    $\begin{cases}
         b \equiv \lambda \pmod{p}\\
         b \equiv 1 \pmod{\frac{n}{p}}
    \end{cases}$
\end{pf}

\begin{itemize}
    \item Solovay-Strassen primality test ------ random bases, check whether Euler
    \item probabilistic primality test
    \item strong pseudoprime to base $b$ ------ $n$ odd composite, $(b, n) = 1$, $n - 1 = 2^s t$, $b^t \equiv 1 \pmod{n}$ or $b^{2^r t} \equiv -1 \pmod{n}$
    for $0 \leq r \leq s - 1$
\end{itemize}

\begin{prop}
    strong $\Rightarrow$ Euler
\end{prop}

\begin{thm}
    $n$ odd composite, $n$ strong pseudoprime at most $\frac{1}{4}$ all possible bases
\end{thm}

\begin{itemize}
    \item Miller-Rabin primality test ------ check for $b^t, b^{2t}$ and so on
    \item deterministic tests
\end{itemize}

\begin{setting}
    $N = ab$, odd composite, not square, $\begin{cases}
                                             r = \frac{a+b}{2}\\
                                             s = \frac{a-b}{2}
    \end{cases}$
\end{setting}

\begin{fact}
    $N = r^2 - s^2$
\end{fact}

\begin{example}[Fermat factorisation]
    \begin{enumerate}
        \item $r = \floor{\sqrt{N}} + 1, \floor{\sqrt{N}} + 2, \dots$
        \item if $r^2 - N = s^2$, then $N = (r-s)(r+s)$
    \end{enumerate}
\end{example}

\begin{itemize}
    \item least absolute residue of $b$, $\left< b \right>$
    \item factor base $B$ ------ set of few small primes, with $-1$
    \item $B$-number ------ $\left< b^2 \right>$ product of elements from $B$
\end{itemize}

\begin{example}[Factor base method]\,
    \begin{enumerate}
        \item choose factor base $B$
        \item choose some $B$-numebers $b_1, \dots, b_k$
        \item Find $I$ st $\prod_I \left< b^2_i \right>$ square
        \item $b = \prod_I b_i$, $c^2 = \prod_I \left< b^2_i \right>$
        \item compute $(N, b+c), (N, b-c)$ hope not trivial factor
    \end{enumerate}
\end{example}

\begin{fact}
    consider vector space over $\mathcal{F}_2$, $\#$ $B$-numbers $\geq |B| + 1$, guarantees to have dependence
\end{fact}

\begin{fact}
    try $\floor{kN}, \floor{kN} + 1$ for $B$-numbers
\end{fact}

\begin{lemma}
    $\frac{p_n}{q_n}$ convergent for $\sqrt{N}$, then
    \begin{enumerate}
        \item $\left< p_n^2 \right> = p_n^2 - q_n^2 N$
        \item $| \left< p_n^2 \right> | \leq 2 \sqrt{N}$
    \end{enumerate}
\end{lemma}

\begin{example}[Continued fraction method]
    calculate $\left< p_n^2 \right>$ to find $B$-numbers
\end{example}

\begin{example}[Pollard's $p-1$ method]
    \begin{enumerate}
        \item $k$ product of small prime (e.g. $\lcm(1, \dots, B)$)
        \item $(a, N)$ (e.g. $a = 2, 3$ or random)
        \item compute $a^k \pmod{N}$
        \item compute $(N, a^k - 1)$ and hope for proper factor
    \end{enumerate}
\end{example}


