\section{Pricing contingent claims}\label{sec:pricing-contingent-claims}

\begin{itemize}
    \item asset price model $(\bar S_n)_{0\leq n \leq T}$ with numeraire
    \item numeraire $(S_n^0)$ ------ $S^0_n > 0$
    \item discounted prices $X_n^i$ ------ $X_n^i = S^i_n / S_n^0$
    \item $\bar X_n = (1, X_n)$
    \item interest rate $r_n$ ------ $S_n^0 = (1 + r_n) S^0_{n-1}$
    \item risky assets $(S_n)$
    \item portfolio $\bar \theta_n$
    \item self-financing ------ $\bar \theta_n \bar S_n = \bar \theta_{n+1} \bar S_n$
    \item value process $(V_n)$ ------ $V_0 = \bar \theta_1 \bar X_0$, $V_n = \bar \theta_n \bar X_n$
    \item total (discounted) value
    \item previsible ------ if $\bar \theta_n$ $\F_{n-1}$-measurable
\end{itemize}

\begin{setting}\,
    \begin{enumerate}
        \item $(\F_n)$ filtration generated by $(\bar S_n)$, $\F = \F_T$
        \item $(S_n)$ takes countable values
        \item $(S_n^0)$ deterministic process
    \end{enumerate}
\end{setting}

\begin{prop}
    $(\theta_n)$ preivisible process, then $\exists$ $(\theta_n^0)$ st
    \begin{enumerate}
        \item $(\theta_n^0)$ previsible
        \item $(\bar\theta_n^0)$ self-financing with initial value $V_0$
        \item $V_T = V_0 + \sum^T_1 \theta_n(X_n - X_{n-1})$
    \end{enumerate}
\end{prop}

\begin{itemize}
    \item contingent claim of maturity $T$ ------ non-negative $\F_T$-measurable r.v.
    \item European option
    \item call with strike price $K$ ------ $(S_T - K)^+$
    \item put with strike price $K$ ------ $(S_T - K)^-$
    \item options
    \item exotic options ------ depending on entire path $(S_n)$
    \item barrier options ------
    \begin{itemize}
        \item knocked out
        \item knocked in
    \end{itemize}
    \item up-and-out call ------ $C = \begin{cases}
                                          (S_T - K)^+ & \text{if } \max S_n < B\\
                                          0 & \text{otherwise}
    \end{cases}$
    \item down-and-in put ------ $C = \begin{cases}
                                          (S_T - K)^- & \text{if } \min S_n \leq B\\
                                          0 & \text{ptherwise}
    \end{cases}$
\end{itemize}

\begin{itemize}
    \item $\tilde{\Pb}$ equivalent to $\Pb$, $\tilde \Pb \sim \Pb$ ------ $\exists \rho$, st
    \begin{itemize}
        \item $\Pb(\rho > 0 ) = 1$
        \item $\tilde\Pb(A) = \Ex(\rho \In_A)$
    \end{itemize}
    \item density $\rho = d\tilde\Pb / d\Pb$ for $\tilde \Pb$ wrt $\Pb$
\end{itemize}

\begin{fact}
    $\tilde\Ex(X) = \Ex(\rho X)$
\end{fact}

\begin{fact}
    $\tilde \Pb \sim \Pb$ symmetric and transitive
\end{fact}

\begin{fact}
    $d\Pb/d\tilde\Pb = 1/\rho$ a.s.\
\end{fact}

\begin{itemize}
    \item arbitrage for $(\bar S_n)_{0\leq n \leq T}$ ------
    \begin{enumerate}
        \item $(\bar\theta_n)_{1 \leq n \leq T}$ previsible, self-financing
        \item $V_0 = 0$
        \item $V_T \geq 0$ a.s.
        \item $V_T > 0$ with positive probability
    \end{enumerate}
\end{itemize}

\begin{itemize}
    \item $(\bar S_n)$ arbitrage free
\end{itemize}

\begin{prop}
    $(X_n)$ martingale $\Rightarrow$ $(X_n)$ arbitrage free
\end{prop}

\begin{fact}
    proof can be simpler when $(\theta_n)$ bounded
\end{fact}

\begin{setting}
    single period model, $\F_0 = {\varnothing, \Omega}$
\end{setting}

\begin{prop}
    $Y$ r.v., following equivalent:
    \begin{enumerate}
        \item arbitrage free (i.e.\ no $\theta$ st $\theta Y \geq 0$ a.s. with $\theta Y > 0$ with positive prob)
        \item $\exists$ equivalent probability measure $\tilde \Pb$ st $Y$ integrable with $\Ex(Y) = 0$
    \end{enumerate}
\end{prop}

\begin{itemize}
    \item equivalent martingale measure $\tilde \Pb$ (risk neutral measure) ------ $\tilde \Pb \sim \Pb$, $(X_n)$ martingale under $\tilde \Pb$
\end{itemize}

\begin{thm}
    following equivalent:
    \begin{enumerate}
        \item $(\bar S_n)$ arbitrage free
        \item $(\bar S_n)$ has equivalent martingale measure
    \end{enumerate}
\end{thm}

\begin{setting}
    $C$ time-T contigent claim, $D = C/S_T^0$ discounted value
\end{setting}

\begin{itemize}
    \item attainable/replicable ------ $\exists$ previsible, self-financing $\bar(\theta_n)$ st $C = \bar \theta_n \bar S_T$
\end{itemize}

\begin{fact}
    Alternative def: $\exists V_0$ $\F_0$-measurable, $\theta_n$ previsible st $D = V_0 + \sum^T \theta_n (X_n - X_{n-1})$
\end{fact}

\begin{itemize}
    \item fair price ------ $V_0$
    \item replicating portfolio/hedging portfolio ------ $\bar \theta_n$
    \item $(\bar S_n)$ complete ------ all contingent claims attainable
\end{itemize}

\begin{prop}
    $\F_0 = \left\{ \varnothing, \Omega \right\}$, $\F_T = \sigma(\bar S_1)$
    \begin{enumerate}
        \item $C$ non-negative, attainable, time-T contingent claim, $\tilde \Pb$ equivalent martingale measure, then\\
        fair price $V_0 = \tilde \Ex(D)$, $D = C/S_T^0$
        \item $(\bar S_n)$ complete, numeraire non-random, then at most one equivalent martingale measure
    \end{enumerate}
\end{prop}

\begin{itemize}
    \item binomial model (Cox-Ross-Rubinstein model) ------ interest rate $r$, parameters $a < b$, $R_i$ i.i.d.\ with parameter$p$
    \begin{itemize}
        \item $S^0_n = (1+r)^n$
        \item $S_n = S_0 \prod(1 + R_k)$
        \item \begin{cases}
                  \Pb(R_1 = a) = 1 - p \\
                  \Pb(R_1 = b) = p
        \end{cases}
    \end{itemize}
\end{itemize}

\begin{prop}
    binomial model has arbitrage unless $r \in (a, b)$
\end{prop}

\begin{prop}
    $(\bar S_n)$ binamial model, $r \in (a,b)$, define
    \begin{enumerate}
        \item $p^* = \frac{r - a}{b - a}$
        \item equivalent prob measure $\dv{\Pb^*}{\Pb} = \left( \frac{p^*}{p} \right)^{U_T} \left( \frac{1 - p^*}{1 - p} \right)^{D_T}$ where $U_T = (T + S_T)/2, D_T = (T - S_T)/2$, $S_T$ number of $b$
    \end{enumerate}
    Then under $\Pb^*$,
    \begin{enumerate}
        \item $R_1, \dots, R_T$ i.i.d.\ , \begin{cases}
                  \Pb^*(R_1 = a) = 1 - p^* \\
                  \Pb^*(R_1 = b) = p^*
        \end{cases}
        \item $(X_n)$ martingale under $\Pb^*$
    \end{enumerate}
\end{prop}

\begin{fact}
    $r = \Ex^*(R_1)$
\end{fact}

\begin{fact}
    Binomial model arbitrage free when $r \in (a, b)$
\end{fact}

\begin{setting}
    if $C = f(S_0, \dots, S_T)$, then
    \begin{align*}
        V(C) = \frac{\Ex^*(C)}{(1 + r)^T} = (1 + r)^{-T} \sum f(s_0, s_1, \dots, s_T)\Pb^*(S_1 = s_1, \dots, S_T = s_T)
    \end{align*}
    Define recursive relation:
    \begin{align*}
        &f_T(s_0, \dots, s_T) = f(s_0, \dots, s_T)\\
        &f_n(s_0, \dots, s_n) = (1 - p^*) f_{n+1} (s_0, \dots, s_n, (1 + a)s_n) + p^* f_{n+1} (s_0, \dots, s_n, (1 + b)s_n)
    \end{align*}
\end{setting}

\begin{prop}
    $\Ex^*(f(S_0, \dots, S_T) | \F_n) = f_n(S_0, \dots, S_n)$, $\Ex^*(C) = f_0(S_0)$
\end{prop}

\begin{prop}
    Define
    \begin{align*}
        \Delta_n(s_0, \dots, \s_{n-1}) = \frac{f_n(s_0, \dots, s_{n-1}, (1 + b)s_{n-1}) - f_n(s_0, \dots, s_{n-1}, (1 + a)s_{n-1})}{(1+r)^{T-n}(b-a)s_{n-1}}
    \end{align*}
    then $\theta_n = \Delta_n(S_0, \dots, S_{n-1})$ replicating portfolio for $C$
\end{prop}

\begin{fact}
    Binomial model complete when $ r \in (a, b)$
\end{fact}

\begin{prop}
    $(W_n)$ simple random walk with $\Pb(W_1 = 1) = p$, let $M_T = \max W_n$, then with $k \leq T$, $2k - T \leq m \leq k$
    \begin{align*}
        \Pb(M_T = m, W_T = 2k - T) = \left( {T \choose k-m} - {T \choose k - m -1} \right)p^k(1-p)^{T-k}
    \end{align*}
\end{prop}

\begin{example}
    if $(1 + a)(1 + b) = 1$, then $S_n = S_0(1 + b)^{W_n}$, so can give fair price of $C = F(S_T, \max S_n)$
\end{example}

